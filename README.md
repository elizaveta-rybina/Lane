# Lane Detection (Java + OpenCV)

Проект определяет дорожные полосы на видео, сглаживает их положение между кадрами и рисует:

- левую и правую границы полосы;
- полигон дорожного коридора;
- стрелку направления движения.

## Что изменено в рефакторинге

Монолитная логика из `Main` разделена на отдельные классы:

- `Main` — только orchestration: загрузка видео, цикл кадров, вызовы пайплайна и рендера.
- `LanePipeline` — обработка кадра (gray/blur/canny/ROI/Hough) и вычисление параметров полос.
- `LaneSmoother` — экспоненциальное сглаживание параметров между кадрами.
- `LaneEstimate` — неизменяемая модель результата детекции на кадре.
- `LaneRenderer` — отрисовка линий, полигона и стрелки.
- `LaneUtils` — утилита маски ROI (нижняя трапеция кадра).
- `ImageViewer` — отображение кадра через Swing.

## Требования

- Java 17+
- Maven 3.8+

## Запуск

Все тестовые видео хранятся в папке `video/`.

Из корня проекта:

```bash
mvn -q clean package
mvn -q exec:java -Dexec.mainClass=org.example.Main
```

Запуск с пользовательским видео:

```bash
mvn -q exec:java -Dexec.mainClass=org.example.Main -Dexec.args="/path/to/video.mp4"
```

Запуск с видео из папки `video/` (достаточно передать имя файла):

```bash
mvn -q exec:java -Dexec.mainClass=org.example.Main -Dexec.args="V1_regular.mp4"
```

Если видео не передано, используется `video/road.mp4`.

## Пайплайн обработки

1. `BGR -> Grayscale`
2. `GaussianBlur(5x5)`
3. `Canny(50, 150)`
4. Маска ROI (нижние 40% кадра, трапеция)
5. `HoughLinesP` для поиска сегментов
6. Классификация левых/правых линий по знаку наклона и позиции
7. Экспоненциальное сглаживание ($\alpha = 0.2$)
8. Отрисовка и полупрозрачное наложение на кадр
